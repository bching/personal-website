<!DOCTYPE html>
<html>
  <head>
    <title>BYCHING</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="assets/css/main.css?version=1"/>
     <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
           crossorigin=""/>
    <link href="https://fonts.googleapis.com/css?family=Oswald&display=swap" rel="stylesheet">
    <script type="text/javascript" src="assets/data/places.json"></script>
  </head>

  <body id="bg">
    <header>
      <!-- B_O_Y_D logo -->
      <div id="logo">
        <a>
          <svg width="173" height="23" viewBox="0 0 173 23" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M0 4.492V0.799999H30.888V7.95L24.934 9.9L30.888 11.85V19H3.874V4.492H0ZM10.66 15.308H24.102V13.982L18.98 11.746H10.66V15.308ZM10.66 8.054H18.98L24.102 5.818V4.492H10.66V8.054ZM51.4262 19V0.799999H78.4402V19H51.4262ZM58.2122 15.308H71.6542V4.492H58.2122V15.308ZM96.3767 4.492V0.799999H104.879L112.029 8.366L118.503 0.799999H126.485L115.409 13.748V19H108.623V13.41L100.199 4.492H96.3767ZM141.553 4.492V0.799999H164.121L172.415 5.22V19H145.427V4.492H141.553ZM152.239 15.308H165.655V6.26L162.327 4.492H152.239V15.308Z"
              fill="#E2DFDF" />
            <path
              d="M33.2363 19H48.8363V22.692H33.2363V19ZM81.0469 19H96.6469V22.692H81.0469V19ZM125.963 19H141.563V22.692H125.963V19Z"
              fill="#D8B608" />
          </svg>
        </a>
      </div>
      <nav>
        <ul id="nav-items">
          <li><a href="#">Posts</a></li>
          <li><a href="#">Github</a></li>
          <li><a href="#">Contact</a></li>
        </ul>
      </nav>
      <nav id="mobile-nav">
        <div style="--animation-order: 1;">
          <a href="#">Posts</a>
        </div>
        <div style="--animation-order: 2;">
          <a href="#">Github</a>
        </div>
        <div style="--animation-order: 3;">
          <a href="#">Contact</a>
        </div>
      </nav>
      <button id="open-nav-button" onclick="openNav()">
      </button>
    </header>

    <div id="waves-wrapper">
      <div id="waves">
        <svg width="1411" height="168" viewBox="0 0 1411 168" fill="none" preserveAspectRatio="none"
          xmlns="http://www.w3.org/2000/svg">
          <path d="M368.029 166.645L536.765 83.3226L705.5 0H0L368.029 166.645Z" fill="#454444" />
          <path d="M1060.21 168L1411 3.05176e-05H705.5L1060.21 168Z" fill="#454444" />
        </svg>
      </div>
    </div>

    <div class="max-width-wrapper">

      <!-- Boyd's thoughts -->
      <div class="fade-in-wrapper">
        <div class="fade-in-section">
          <div class="flex-row flex-center">
            <h1>Inspirational Quote!</h1>
          </div>
          <div class="flex-row flex-center">
            <div class="text-box popper">
              <h2>Inspirational quote here!</h2>
            </div>
          </div>
        </div>
      </div>
    
      <!-- Boyd's skill summary -->
      <div class="fade-in-wrapper">
        <div class="fade-in-section">
          <div class="flex-row flex-center">
            <h2>Boyd is a...</h1>
          </div>
          <div class="flex-row flex-center">
            <h1><u>Software Developer</u></h1>
          </div>
          <div class="flex-row flex-center">
            <div class="list-wrapper">
              <div>
                <h2>Languages</h2>
                <ul>
                  <li>Javascript</li>
                  <li>NodeJS</li>
                  <li>Typescript</li>
                  <li>HTML</li>
                  <li>CSS</li>
                </ul>
              </div>
              <div>
                <h2>Tools & Libraries</h2>
                <ul>
                  <li>ReactJS</li>
                  <li>Express</li>
                  <li>Git</li>
                  <li>Docker</li>
                  <li>Figma (designed in Figma :)</li>
                  <li>AWS</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Dance Range Slider -->
      <div class="fade-in-wrapper">
        <div class="fade-in-section">
          <div class="flex-row flex-center" style="padding-bottom: 5px;">
            <button class="play-button" onclick="execDance()">
              <span class="h2-style">
                GO!
              </span>
              <!-- <div class="play-button-wrapper">
                <svg viewBox="0 0 150 150" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
                  <path
                    d="M14.4721 136.764C7.82313 140.088 0 135.253 0 127.82V10.1803C0 2.74653 7.82313 -2.08843 14.4721 1.23607L132.111 60.0557C139.482 63.741 139.482 74.259 132.111 77.9443L14.4721 136.764Z"
                    fill="#D8B608" />
                </svg>
              </div> -->
            </button>
          </div>
          <div class="flex-row flex-center" style="padding-bottom: 10px;">
            <input type="range" min="1" max="6" value="1" class="slider" id="img-range">
          </div>
          <div class="flex-row flex-center">
            <button onclick="nextClip()">
              <svg width="67" height="120" viewBox="0 0 67 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M62 109.63V10.3702C62 5.83213 56.4412 3.641 53.3447 6.95863L7.02358 56.5884C5.23062 58.5094 5.23062 61.4906 7.02359 63.4116L53.3447 113.041C56.4412 116.359 62 114.168 62 109.63Z"
                  fill="#FCFCFC" stroke="black" stroke-width="10" />
              </svg>
            </button>
            <div>
              <canvas id="canvas">
              </canvas>
            </div>
            <button onclick="nextClip()">
              <svg width="67" height="120" viewBox="0 0 67 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M5 109.63V10.3702C5 5.83213 10.5588 3.641 13.6553 6.95863L59.9764 56.5884C61.7694 58.5094 61.7694 61.4906 59.9764 63.4116L13.6553 113.041C10.5588 116.359 5 114.168 5 109.63Z"
                  fill="#FCFCFC" stroke="black" stroke-width="10" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      let currImgIndex = 1;
      let isDancing = false;
      let currClipIndex = 0;
      const clipCounts = [ 6, 21 ];
      document.addEventListener("DOMContentLoaded", function () {

        const image = createImg(currImgIndex);
        image.addEventListener('load', () => {
          renderFrame(image);
        })

        const slider = document.getElementById("img-range");
        slider.oninput = (e) => {
          if(isDancing) {
            isDancing = false;
          }
          console.log('current num:', e.target.value)
          currImgIndex = parseInt(e.target.value);
          const newImage = createImg(currImgIndex);
          newImage.addEventListener('load', () => {
            renderFrame(newImage);
          });
        };
      });

      function execDance() {
        if(isDancing) {
          return;
        }
        if(!isDancing) {
          isDancing = true;
        }
        const slider = document.getElementById('img-range');
        if(currImgIndex === clipCounts[currClipIndex]) {
          currImgIndex = 1;
          slider.value = currImgIndex;
        }
        const intervalId = window.setInterval(() => {
          if(!isDancing) {
              window.clearInterval(intervalId);
              return;
          }
          const img = createImg(currImgIndex);
          img.addEventListener('load', () => {
            renderFrame(img);
            currImgIndex = currImgIndex + 1;
            slider.value = currImgIndex;
            if(currImgIndex >= clipCounts[currClipIndex] + 1) {
              window.clearInterval(intervalId);
              currImgIndex = 1;
              slider.value = currImgIndex;
              isDancing = false;
            }
          });
        }, 100)
      }

      function nextClip() {
        const imgRange = document.getElementById('img-range');
        currClipIndex = currClipIndex + 1;
        if(currClipIndex > 1) {
          currClipIndex = 0;
        }
        imgRange.max = clipCounts[currClipIndex];
        currImgIndex = 1;
        renderFrame();
      }

      function createImg(imgIndex) {
        const image = document.createElement('img');
        image.id = "halo-frame";
        image.className = "center-self";
        image.style = "width: 100%; height: 100%;"
        image.src = `./assets/dance-frames-${currClipIndex}/frame_${currImgIndex}.jpg`;
        return image;
      }

      function renderFrame(img = null) {
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        if (img) {
          canvas.width = 1080;
          canvas.height = 1920;
          ctx.drawImage(img, 0, 0);
          return;
        }
        const image = createImg(currImgIndex);
        image.addEventListener('load', () => {
          ctx.drawImage(image, 0, 0);
        })
      }
    </script>

    <script type="text/javascript">
      // Implement delay until page visiblity
      // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API/Timing_element_visibility

      // let mNavOpened = false;
      // console.log('mnavopened', mNavOpened)
      const mNav = document.getElementById("mobile-nav");
      function openNav() {
        console.log(mNav.classList)
        if(mNav.classList.contains('opened')) {
          mNav.classList.remove('opened');
          mNav.classList.add('closed');
          // mNavOpened = false;
          return;
        }
        mNav.classList.remove('closed');
        mNav.classList.add('opened');
        // mNavOpened = true;
      }

      let options = {
        root: null,
        rootMargin: '0px',
        threshold: [0, 0.2]
      }

      let observer = new IntersectionObserver(function(entries, observer) {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            if (entry.intersectionRatio >= 0.2) {
              entry.target.classList.add('is-visible');

              const poppers = entry.target.getElementsByClassName('popper');
              if (poppers.length) {
                window.setTimeout(() => {
                  for (pop of poppers) {
                    pop.classList.add('pop-out');
                    pop.addEventListener('mouseenter', (e) => {
                      if (!e.target.classList.contains('pop-out')) {
                        e.target.classList.remove('pop-in');
                        e.target.classList.add('pop-out');
                      }
                    })
                    pop.addEventListener('mouseleave', (e) => {
                      if (!e.target.classList.contains('pop-in')) {
                        e.target.classList.remove('pop-out');
                        e.target.classList.add('pop-in');
                      }
                    })
                  }
                  window.setTimeout(() => {
                    pop.classList.remove('pop-out');
                    pop.classList.add('pop-in');
                  }, 700)
                }, 1300);
              }

              observer.unobserve(entry.target);
            }
          }
        });
      }, options);

      const contentItems = document.getElementsByClassName('fade-in-section');
      for(item of contentItems) {
        observer.observe(item);
      }
    </script>
</body>
</html>
